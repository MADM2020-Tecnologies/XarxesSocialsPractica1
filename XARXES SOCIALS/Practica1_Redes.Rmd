---
title: "Handout 1"
author: "Guillermo Gavilla, Miquel Antoni Llamb√≠as Cabot"
date: "07/11/2020"
output:
  pdf_document: default
  html_document: default
---

```{r global_options, include=FALSE}
knitr::opts_chunk$set(fig.width=8, fig.height=8, fig.align="center", echo=TRUE, warning=FALSE, message=FALSE)
library(knitr)
library(igraph)
```

**1)** The file **facebook_sample_anon.txt** is a data table containing the list of edges of an anonymized  sample of the Facebook friendship network. Download it on your computer,  upload it to R as a dataframe, and define an undirected graph with this list of edges.

*a)* Is it connected? If it is not, replace it by its largest connected component.

*b)* Compute the edge density.

*c)* What is the mean distance among the subjects?

*d)* Calculate the list of vertices in a diameter of the graph. Plot only this path with the size of the node proportional to the degree of the node.

*e)* Calculate the shortest path from the vertex named "1000" to the vertex named "2000" in the original file.

*f)* Calculate a clique of  5 friends, if there is one.

*h)* Calculate the list of names of verteces that are the neigbours of verteces of degree one and that are not of degree one.


# Undirected Graph.

```{r}
data <- read.table("facebook_sample_anon.txt")
tail(data)
```
Load data

```{r}
#graph <- graph_from_data_frame(data, directed = F)
graph <- make_graph(~ A-B-C-D-A, E-A:B:C:D,
                    F-G-H-I-F, J-F:G:H:I,
                    K-L-M-N-K, O-K:L:M:N,
                    P-Q-R-S-P, T-P:Q:R:S,
                    B-F, E-J, C-I, L-T, O-T, M-S,
                    C-P, C-L, I-L, I-P)
graph <- set_graph_attr(graph, "title", "Facebook sample anon")
plot(graph)
```

# a) Is it connected? If it is not, replace it by its largest connected component.

```{r}
vertexConnectivityBool <- vertex_connectivity(graph, source = NULL, target = NULL, checks = TRUE)
vertexConnectivityBool
```
```{r, echo=FALSE}
if(vertexConnectivityBool > 0) {
  print("Graph is connected")
} else {
  print("Graph is not connected")
}
```

# b) Compute the edge density
```{r}
density <- edge_density(graph, loops = F)
```
```{r, echo = FALSE}
print(paste("The edge density is", density, sep = " "))
```

# c) What is the mean distance among the subjects?

```{r}
meanDistance <- mean_distance(graph, directed=F)
```
```{r, echo = FALSE}
print(paste("The mean distance is", meanDistance, "nodes", sep = " "))
```

# d) Calculate the list of vertices in a diameter of the graph. Plot only this path with the size of the node proportional to the degree of the node.

Calculate the proportional degree of the node and link the max weight of the linked nodes

```{r}
AddWeightsFromDegree <- function (graph) {
  res <- graph
  for(v in V(graph = res)$name) {
    degree <- degree(res, v)
    #print(paste('vertex', v, 'have a degree if', degree, sep=' '))
    E(res) [ from(v) ]$weight <- degree
  }
  result <- res
}
is_weighted(graph)
weightedGraph <- AddWeightsFromDegree(graph)
is_weighted(weightedGraph)
E(weightedGraph)[from(V(weightedGraph)$name[1])]$weight
```

Calculate the diameter

```{r}
diameter <- diameter(weightedGraph, directed = FALSE)
diameterNodes <- get_diameter(weightedGraph, directed = FALSE)
```
```{r, echo = FALSE}
print(paste("The graph diameter is", diameter, "units", sep = " "))
```
```{r, echo = FALSE}
buildAdjencyGraphFromList <- function (list) {
  length <- length(list)
  res <- matrix(data = 0, ncol = length, nrow = length, dimnames = list(list$name, list$name))
  for(v in 1:length-1) {
    res[v,v+1] <- 1
  }
  result <- graph.adjacency(res, mode = 'undirected')
}
res <- buildAdjencyGraphFromList(diameterNodes)
plot(res)
```
# e) Calculate the shortest path from the vertex named "1000" to the vertex named "2000" in the original file.

Graph is connected, then it exists a path between node1 = 1000 and node2 = 2000.


```{r}
#vertex1 <- '1000'
#vertex2 <- '2000'
vertex1 <- 'A'
vertex2 <- 'N'
paintedGraf <- graph
shortestPath <- get.shortest.paths(
        graph,
        from = V(graph)$name == vertex1,
        to = V(graph)$name == vertex2,
        weights = NULL,
        output = "vpath",
        predecessors = FALSE,
        inbound.edges = FALSE
)

E(paintedGraf, path=shortestPath$vpath[[1]])$color <- "red"
plot(paintedGraf)
```

# f) Calculate a clique of  5 friends, if there is one.

```{r}
cliquesOf5 <- cliques(graph, min = 5, max = 5)
if(length(cliquesOf5) > 0) {
  print(cliquesOf5)
} else {
  print("This graph does not feature a clique of 5")
}
```

# h) Calculate the list of names of verteces that are the neigbours of verteces of degree one and that are not of degree one.

Get a list of degrees
```{r}
degrees <- degree(graph = graph)
degrees
```


```{r}
degreesOf1 <- which(degrees == 4)
vertexNames <- names(degreesOf1)
vertexNames
```

```{r}
neighbors(graph = graph, v = vertexNames)
```
